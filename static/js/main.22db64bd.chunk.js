(this["webpackJsonpflickr-images"]=this["webpackJsonpflickr-images"]||[]).push([[0],{46:function(e,t,c){},66:function(e,t,c){},73:function(e,t,c){},74:function(e,t,c){},75:function(e,t,c){},76:function(e,t,c){},77:function(e,t,c){},78:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c.n(n),r=c(34),s=c.n(r),i=(c(46),c(8)),o=c(81),l=c(38),d=c(22),j=c.n(d),u=c(35),h=c(80),b=c(40),f=c(36),O="https://live.staticflickr.com/",g=c.n(f).a.create({baseURL:"https://www.flickr.com/services/rest",params:{api_key:"ef1f9d4f8ca80dada31c684364355282",FLickrApi_sig:"d7f57fa9e01a6a2d6ccd8597b8d2f86b",format:"json",nojsoncallback:1,extras:"owner_name,date_upload"}});c(66);var v=c(82),m=c(6),p=c(12),x=c(1),w=function(){var e=new URLSearchParams(Object(m.g)().search),t=Object(n.useState)(e.get("search")||""),c=Object(i.a)(t,2),r=c[0],s=c[1],o=Object(n.useState)(!1),l=Object(i.a)(o,2),d=l[0],f=l[1],w=Object(n.useState)(""),N=Object(i.a)(w,2),k=N[0],y=N[1];Object(v.a)((function(){y(r)}),500,[r]);var C=Object(m.f)();Object(n.useLayoutEffect)((function(){var e=function(){f(window.scrollY<50)};return e(),window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[]),Object(n.useEffect)((function(){r?C.push("/images?search=".concat(r)):C.push("/images")}),[r,C]);var P=Object(h.a)("imageList"+k,function(){var e=Object(u.a)(j.a.mark((function e(t){var c,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.pageParam,n=void 0===c?0:c,e.next=3,r=k,s={page:n},g.get("",{params:Object(b.a)({method:"flickr.photos.search",text:r},s)});case 3:if("ok"===(a=e.sent).data.stat){e.next=6;break}throw new Error(a.data.message);case 6:return e.abrupt("return",a.data);case 7:case"end":return e.stop()}var r,s}),e)})));return function(t){return e.apply(this,arguments)}}(),{getPreviousPageParam:function(e){if(null===e||void 0===e?void 0:e.photos){var t=(null===e||void 0===e?void 0:e.photos).page;return t<2?t-1:void 0}},getNextPageParam:function(e){if(null===e||void 0===e?void 0:e.photos){var t=null===e||void 0===e?void 0:e.photos,c=t.page;return c*t.perpage<t.total?c+1:void 0}}}),S=P.data,I=P.isFetchingNextPage,L=P.fetchNextPage,_=P.hasNextPage,E=a.a.useRef(null);return function(e){var t=e.root,c=e.target,n=e.onIntersect,r=e.threshold,s=void 0===r?1:r,i=e.rootMargin,o=void 0===i?"0px":i,l=e.enabled,d=void 0===l||l;a.a.useEffect((function(){if(d){var e=new IntersectionObserver((function(e){return e.forEach((function(e){return e.isIntersecting&&n()}))}),{root:t&&t.current,rootMargin:o,threshold:s}),a=c&&c.current;if(a)return e.observe(a),function(){e.unobserve(a)}}}),[c.current,d])}({target:E,onIntersect:L,enabled:_}),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{htmlFor:"search-images",children:"Search flickr API"}),Object(x.jsx)("input",{onChange:function(e){return s(e.target.value)},value:r,placeholder:"Type to search...",id:"search-images",type:"text"})]}),(null===S||void 0===S?void 0:S.pages)&&Object(x.jsxs)("div",{className:"image-list-wrap",children:[null===S||void 0===S?void 0:S.pages.map((function(e){var t;return Object(x.jsx)("div",{className:"image-list",children:null===(t=e.photos)||void 0===t?void 0:t.photo.map((function(e){var t="".concat(O).concat(e.server,"/").concat(e.id,"_").concat(e.secret,".jpg");return Object(x.jsxs)("div",{className:"image-item",children:[Object(x.jsx)(p.b,{to:"/edge/".concat(e.id),children:Object(x.jsx)("img",{src:t,alt:e.title})}),Object(x.jsx)("h4",{children:e.title})]},e.id)}))},e.photos.page)})),Object(x.jsx)("button",{className:"to-top ".concat(d&&"hidden"),onClick:function(){window.scrollTo({top:0,behavior:"smooth"})},children:"Top"}),Object(x.jsx)("button",{ref:E,onClick:function(){return L()},disabled:!_||I,className:"load-more-btn",children:I?"Loading more...":_?"Load Newer":"Nothing more to load"})]})]})},N=(c(73),c.p+"static/media/flickr_logo_dots.e5cc7d38.svg"),k=function(e){return Object(x.jsx)("div",{className:"app-header-wrap",children:Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)(p.b,{to:"/",children:Object(x.jsx)("img",{src:N,className:"logo",alt:"logo",title:"logo"})}),Object(x.jsxs)("a",{href:"https://github.com/aaegorof",target:"_blank",rel:"noreferrer",className:"author",children:["Made by ","@aaegorof"]})]})})},y=(c(74),c(75),function(e){var t=e.left,c=e.right,a=e.onChange,r=e.checked,s=e.className,o=Object(n.useState)(r||t),l=Object(i.a)(o,2),d=l[0],j=l[1],u=function(e){j(e.target.value),a(e.target.value)};return Object(x.jsxs)("div",{className:"switch switch--horizontal ".concat(s),children:[Object(x.jsx)("input",{id:"on",type:"radio",name:"switch",value:t,onChange:u,checked:d===t}),Object(x.jsx)("label",{htmlFor:"on",children:t}),Object(x.jsx)("input",{id:"off",type:"radio",name:"switch",value:c,onChange:u,checked:d===c}),Object(x.jsx)("label",{htmlFor:"off",children:c}),Object(x.jsx)("span",{className:"toggle-outside",children:Object(x.jsx)("span",{className:"toggle-inside"})})]})}),C=function(e){var t=e.cv,c=Object(n.useState)(null),a=Object(i.a)(c,2),r=a[0],s=a[1],o=Object(n.useState)(""),l=Object(i.a)(o,2),d=l[0],j=l[1],u=Object(n.useState)([0,0]),h=Object(i.a)(u,2),b=h[0],f=h[1],v=Object(n.useState)(!0),p=Object(i.a)(v,2),w=p[0],N=p[1],k=Object(m.h)(),C=k.id,P=k.secret,S=Object(n.useRef)(null),I=Object(n.useRef)(null),L=Object(n.useRef)(null),_=Object(m.f)();return Object(n.useEffect)((function(){C&&function(e,t){return g.get("",{params:{method:"flickr.photos.getInfo",photo_id:e,secret:t}})}(C,P).then((function(e){var t=e.data.photo;s(t);var c="".concat(O).concat(null===t||void 0===t?void 0:t.server,"/").concat(null===t||void 0===t?void 0:t.id,"_").concat(null===t||void 0===t?void 0:t.secret,".jpg");j(c);var n=new Image;n.src=c,n.onload=function(){f([this.width,this.height])}}))}),[C,P]),Object(n.useEffect)((function(){if(S.current&&t&&r&&d&&b[0]){var e=S.current,c=I.current,n=e.getContext("2d"),a=new Image;a.src=d,a.crossOrigin="Anonymous",a.setAttribute("crossOrigin",""),a.onload=function(){n.drawImage(a,0,0);var r=t.imread(e.id),s=new t.Mat;t.cvtColor(r,r,t.COLOR_RGB2GRAY,0),t.Canny(r,s,50,100,3,!1),t.imshow(c.id,s),r.delete(),s.delete()}}}),[r,t,d,b]),Object(x.jsxs)("div",{className:"image-edges-wrap",children:[Object(x.jsx)("h3",{children:Object(x.jsxs)("a",{onClick:function(){return _.goBack()},className:"go-back",children:[" ","Back to search results"]})}),Object(x.jsxs)("div",{className:"image-card",children:[Object(x.jsxs)("div",{className:"img-wrap",children:[Object(x.jsx)("img",{src:d,id:"cvImage",ref:L}),Object(x.jsx)("canvas",{ref:S,id:"thecanvasId",width:b[0],height:b[1],style:{display:"none"}}),Object(x.jsx)("canvas",{ref:I,id:"thecanvasOutId",width:b[0],height:b[1],style:{display:w?"initial":"none"}})]}),r&&Object(x.jsxs)("div",{className:"photo-info",children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("strong",{children:"Title: "})," ",r.title._content]}),Object(x.jsxs)("p",{children:[Object(x.jsx)("strong",{children:"Posted date: "}),new Date(1e3*r.dates.posted).toLocaleString()]}),Object(x.jsxs)("p",{children:[Object(x.jsx)("strong",{children:"Owner: "}),r.owner.username]}),Object(x.jsxs)("p",{style:{marginTop:50},children:["You can switch the edge detection",Object(x.jsx)(y,{left:"On",right:"Off",onChange:function(e){return N((function(e){return!e}))}})]})]})]}),Object(x.jsx)("div",{children:Object(x.jsx)("div",{className:"inputoutput"})})]})},P=(c(76),c(39)),S=(c(77),function(e){return Object(x.jsx)("div",{className:"home-wrap",children:Object(x.jsxs)("div",{className:"say-hi",children:[Object(x.jsx)("div",{children:"This is home page. Not too much to see here, but give it a try."}),Object(x.jsx)(p.b,{to:"images",className:"btn",children:"Search for images"})]})})}),I=new o.a({defaultOptions:{queries:{retry:0}}});var L=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),c=t[0],a=t[1];return Object(x.jsx)(l.a,{client:I,children:Object(x.jsx)(P.a,{onLoad:function(e){setTimeout((function(){a(window.cv)}),500)},openCvPath:"./libraries/opencv.js",children:Object(x.jsxs)(p.a,{children:[Object(x.jsx)(k,{}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)(m.c,{children:[Object(x.jsx)(m.a,{path:"/",exact:!0,children:Object(x.jsx)(S,{})}),Object(x.jsx)(m.a,{path:"/images",children:Object(x.jsx)(w,{})}),Object(x.jsx)(m.a,{path:"/edge/:id",exact:!0,children:Object(x.jsx)(C,{cv:c})}),Object(x.jsx)(m.a,{path:"*",children:Object(x.jsx)(S,{})})]})})]})})})},_=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,83)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),n(e),a(e),r(e),s(e)}))};s.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(L,{})}),document.getElementById("root")),_()}},[[78,1,2]]]);
//# sourceMappingURL=main.22db64bd.chunk.js.map